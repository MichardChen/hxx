<!DOCTYPE html>
<html>
<head>
	<title>订单数据统计</title>
	#parse("sys/header.html")
	<!-- 引入 echarts.js -->
	<script src="${rc.contextPath}/statics/libs/echarts.min.js"></script>
	<script src="${rc.contextPath}/statics/libs/moment.js"></script>
	<link href="${rc.contextPath}/statics/css/bootstrap-datetimepicker.min.css" rel="stylesheet">
	<script src="${rc.contextPath}/statics/libs/bootstrap-datetimepicker.min.js"></script>
</head>
<body>
<!-- 为ECharts准备一个具备大小（宽高）的Dom -->
<div class="row">
	<div class='col-sm-3'>
		<div class="form-group">
			<label>选择开始时间：</label>
			<!--指定 date标记-->
			<div class='input-group date' id='startDate-datetimepicker'>
				<input type='text' class="form-control" id="startDate"/>
				<span class="input-group-addon">
                    <span class="glyphicon glyphicon-calendar"></span>
                </span>
			</div>
		</div>
	</div>
	<div class='col-sm-3'>
		<div class="form-group">
			<label>选择结束时间：</label>
			<!--指定 date标记-->
			<div class='input-group date' id='endDate-datetimepicker'>
				<input type='text' class="form-control" id="endDate"/>
				<span class="input-group-addon">
                    <span class="glyphicon glyphicon-calendar"></span>
                </span>
			</div>
		</div>
	</div>
	<div class='col-sm-3'>
		<input type="button" class="btn btn-success" onclick="loadData()" value="查询" style="margin-top:25px;"/>
		<input type="button" class="btn btn-primary" onclick="reset()" value="重置" style="margin-top:25px;"/>
	</div>
</div>
<div id="order_type_report_count_amount" style="width: 600px;height:400px; padding: 10px"></div>
<div id="order_type_report_status_count" style="width: 600px;height:400px; padding: 10px"></div>
<script type="text/javascript">
	$('#startDate-datetimepicker').datetimepicker({
		format: 'YYYY-MM-DD',
		locale: moment.locale('zh-cn')
	});
	$('#endDate-datetimepicker').datetimepicker({
		format: 'YYYY-MM-DD',
		locale: moment.locale('zh-cn')
	});
	//重置查询参数
	function reset(){
		$('#startDate').val(null);
		$('#endDate').val(null);
	}
	//加载数据
	function loadData() {
		// 基于准备好的dom，初始化echarts实例，订单分类数量统计
		var order_type_report_count_chart = echarts.init(document.getElementById('order_type_report_count_amount'));
		// 指定图表的配置项和数据
		var param = {
			"startDate": $('#startDate').val(),
			"endDate": $('#endDate').val()
		}
		$.ajax({
			type: "POST",
			url: "../tfishorder/getReportData",
			contentType : 'application/x-www-form-urlencoded',
			dataType:'json',
			data: param,
			success: function(r){
				if(r.code == 0){
					console.log(r);
					var order_type_report_count_option = {
						title: {
							text: '订单分类统计图'
						},
						tooltip: {},
						legend: {
							data:['数量统计', '金额统计']
						},
						xAxis: {
							data: r.result.typeCount.xAxis
						},
						yAxis: {},
						series: [{
							name: '数量统计',
							type: 'line',
							data: r.result.typeCount.series
						}, {
							name: '金额统计',
							type: 'line',
							data: r.result.typeAmount.series
						}]
					};
					// 使用刚指定的配置项和数据显示图表。
					order_type_report_count_chart.setOption(order_type_report_count_option);

					// 基于准备好的dom，初始化echarts实例，订单状态下的订单数量
					var order_type_report_status_count_chart = echarts.init(document.getElementById('order_type_report_status_count'));
					// 指定图表的配置项和数据
					var order_type_report_status_count_option = {
						title: {
							text: '订单各状态数量统计图'
						},
						tooltip: {},
						legend: {
							data:['订单状态']
						},
						xAxis: {
							data: r.result.statusCount.xAxis
						},
						yAxis: {},
						series: [{
							name: '订单状态',
							type: 'line',
							data: r.result.statusCount.series
						}]
					};
					// 使用刚指定的配置项和数据显示图表。
					order_type_report_status_count_chart.setOption(order_type_report_status_count_option);
				}else{
					alert(r.msg);
				}
			}
		});
	}
	loadData();
</script>
</body>
</html>